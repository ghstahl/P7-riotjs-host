{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 82235bf48fb6c78f9924","webpack:///./app/p7-host-core/utils/deep-freeze.js","webpack:///./app/p7-host-core/stores/store-base.js","webpack:///./app/p7-host-core/stores/route-store.js","webpack:///./app/p7-host-core/utils/validators.js","webpack:///./app/p7-host-core/dynamic-jscss-loader.js","webpack:///./app/p7-host-core/router.js","webpack:///./app/p7-host-core/stores/component-loader-store.js","webpack:///./app/p7-host-core/stores/progress-store.js","webpack:///./app/p7-host-core/utils/random-string.js","webpack:///./app/p7-host-core/riotcontrol-ext.js","webpack:///./app/p7-host-core/stores/error-store.js","webpack:///./app/p7-host-core/stores/fetch-store.js","webpack:///./app/p7-host-core/stores/history-store.js","webpack:///./app/p7-host-core/stores/keep-alive-store.js","webpack:///./app/p7-host-core/stores/localstorage-store.js","webpack:///./app/p7-host-core/stores/plugin-registration-store.js","webpack:///./app/p7-host-core/stores/riotcontrol-dispatch-store.js","webpack:///./app/p7-host-core/stores/startup-store.js","webpack:///external \"riot\"","webpack:///./app/p7-host-core/p7-host-core.js","webpack:///./app/p7-host-core/extensions/riot-route-extension.js","webpack:///./app/p7-host-core/index.js","webpack:///./app/p7-host-core/master-event-table.js","webpack:///./app/p7-host-core/components/startup.tag","webpack:///external \"js-cookie\"","webpack:///external \"riot-route\"","webpack:///external \"riotcontrol\"","webpack:///external \"whatwg-fetch\""],"names":["DeepFreeze","freeze","o","Object","getOwnPropertyNames","forEach","prop","hasOwnProperty","isFrozen","StoreBase","_bound","riotHandlers","bindHandler","element","index","array","on","event","handler","unbindHandler","off","bindEvents","unbindEvents","Constants","NAME","NAMESPACE","WELLKNOWN_EVENTS","in","routeDispatch","riotRouteLoadView","out","riotRouteDispatchAck","RouteStore","riot","observable","postResetRoute","_onRouteDispatch","_onRiotRouteLoadView","route","force","console","log","current","currentPath","same","exec","routeState","trigger","routeDispatchAck","view","router","loadView","Validator","validateType","obj","type","name","Error","DynamicJsCssLoader","_componentsAddedSet","Set","_addComponent","component","_findComponent","mySet","add","item","key","_deleteComponent","delete","loadExternalJsCss","addedCompoment","_loadExternalJsCss","error","_removeExternalByFile","filename","filetype","targetelement","targetattr","allsuspects","document","getElementsByTagName","i","length","getAttribute","indexOf","parentNode","removeChild","unloadExternalJsCss","jsBundle","cssBundle","path","_preFetchExternalJsCss","fileref","createElement","setAttribute","appendChild","Router","r","create","resetCatchAll","stop","state","registeredPlugins","registrants","routeContributer","contributeRoutes","_contributeCatchAllRoute","contributeCatchAllRoute","componentLoaderState","components","loaded","routeLoad","control","EVT","componentLoaderStore","loadDynamicComponent","routeStore","defaultRoute","_currentView","unmount","mount","addDynamicComponent","addDynamicComponents","unloadDynamicComponent","pluginRegistered","pluginUnregistered","allComponentsLoadComplete","componentLoaderStoreStateUpdated","ComponentLoaderStore","dynamicJsCssLoader","_components","_onLoadDynamicComponent","_onUnloadDymanicComponent","_onAddDynamicComponent","_onAddDynamicComponents","_onPluginRegistered","_onPluginUnregistered","_commitToState","componentsArray","Array","from","Map","map","registration","onLoad","triggerItem","data","onUnload","comp","_allLoadedCompleteCheck","ack","evt","pluginRegistrationStore","pluginUnregistration","result","loadedComplete","inprogressDone","inprogressStart","progressStart","progressCount","progressDone","ProgressStore","_count","_onInProgressStart","_onInProgressDone","count","RandomString","self","namespace","generateRandomString","text","possible","charAt","Math","floor","random","hashString","str","hash","charCodeAt","randomHash","RiotControlExt","_stores","store","addStore","remove","splice","RSWKE","constants","errorCatchAll","ErrorStore","_error","_onError","PSWKE","fetch","FetchStore","_onFetch","_onLocalFetch","input","window","boundAsync","response","url","location","origin","frontPath","pathname","substring","lastIndexOf","fetchLocal","then","json","JSON","parse","ok","init","antiforgery","jsonFixup","protocol","startsWith","fetchStore","cookieName","headerName","token","Cookies","get","headers","credentials","body","stringify","status","method","catch","ex","HistoryStore","onpopstate","_onPopState","fetchHeadResult","enable","disable","keptAlive","KeepAliveStore","_onFetchHeadResult","_onEnable","_onDisable","_keepAlive","w","global","_oldOpen","XMLHttpRequest","prototype","open","onStateChange","currentTarget","readyState","_onHttpMonitor","responseURL","addEventListener","apply","polyfill","_oldFetch","timer","setInterval","_onTimer","clearInterval","n","myAck","keepAlive","localstorageSet","localstorageGet","localstorageRemove","localstorageClear","LocalStorageStore","_onSet","_onGet","_onRemove","_onClear","query","localStorage","setItem","stored","getItem","riotControl","removeItem","clear","pluginRegistration","PluginRegistrationStore","riotControlExt","_registerPlugin","_unregisterPlugin","_findRegistration","registrationName","_removeRegistration","foundRegistration","stores","postLoadEvents","dispatch","RiotControlDispatchStore","_onDispatch","start","fetchConfig","fetchConfigResult","fetchConfigResult2","componentsAdded","configComplete","StartupStore","_startupComplete","_done","_onStart","_onFetchConfig","_onFetchConfigResult2","_onFetchConfigResult","_onComponentsAdded","errorStore","code","myAck2","nextTag","P7HostCore","_masterEventTable","_name","Initialize","randomString","_internal","_riotRouteExtension","_progressStore","_dynamicJsCssLoader","_errorStore","_fetchStore","_localStorageStore","_riotControlExt","_routeStore","_keepAliveStore","_historyStore","_componentLoaderStore","_pluginRegistrationStore","_riotControlDispatchStore","_startupStore","RiotRouteExtension","_defaultParser","split","_getCurrentPath","parser","MasterEventTable","keepAliveStore","progressStore","localStorageStore","riotControlDispatchStore","startupStore","historyStore","require","tag2","opts","config","_bind","onConfigComplete","_unbind"],"mappings":"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","file":"P7HostCore.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"riot\"), require(\"js-cookie\"), require(\"riot-route\"), require(\"riotcontrol\"), require(\"whatwg-fetch\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"P7HostCore\", [\"riot\", \"js-cookie\", \"riot-route\", \"riotcontrol\", \"whatwg-fetch\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"P7HostCore\"] = factory(require(\"riot\"), require(\"js-cookie\"), require(\"riot-route\"), require(\"riotcontrol\"), require(\"whatwg-fetch\"));\n\telse\n\t\troot[\"P7HostCore\"] = factory(root[\"riot\"], root[\"js-cookie\"], root[\"riot-route\"], root[\"riotcontrol\"], root[\"whatwg-fetch\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_18__, __WEBPACK_EXTERNAL_MODULE_24__, __WEBPACK_EXTERNAL_MODULE_25__, __WEBPACK_EXTERNAL_MODULE_26__, __WEBPACK_EXTERNAL_MODULE_27__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 21);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 82235bf48fb6c78f9924","// https://github.com/substack/deep-freeze\r\n\r\nexport default class DeepFreeze {\r\n  static freeze(o) {\r\n    Object.freeze(o);\r\n    Object.getOwnPropertyNames(o).forEach(function (prop) {\r\n      if (o.hasOwnProperty(prop) &&\r\n          o[prop] !== null &&\r\n          (typeof o[prop] === 'object' || typeof o[prop] === 'function') &&\r\n          !Object.isFrozen(o[prop])) {\r\n        DeepFreeze.freeze(o[prop]);\r\n      }\r\n    }\r\n    );\r\n    return o;\r\n  }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/utils/deep-freeze.js"," export default class StoreBase {\r\n   constructor() {\r\n     this._bound = false;\r\n     this.riotHandlers = [];\r\n   }\r\n   static bindHandler(element, index, array) {\r\n     this.on(element.event, element.handler);\r\n   }\r\n   static unbindHandler(element, index, array) {\r\n     this.off(element.event, element.handler);\r\n   }\r\n   bindEvents() {\r\n     if (this._bound === false) {\r\n       this.riotHandlers.forEach(StoreBase.bindHandler, this);\r\n       this._bound = !this._bound;\r\n     }\r\n   }\r\n   unbindEvents() {\r\n     if (this._bound === true) {\r\n       this.riotHandlers.forEach(StoreBase.unbindHandler, this);\r\n       this._bound = !this._bound;\r\n     }\r\n   }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/store-base.js","import DeepFreeze from '../utils/deep-freeze.js';\r\nimport StoreBase from './store-base.js';\r\n\r\nclass Constants {}\r\nConstants.NAME = 'route-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n    routeDispatch: 'riot-route-dispatch',\r\n    riotRouteLoadView: 'riot-route-load-view'\r\n  },\r\n  out: {\r\n    riotRouteDispatchAck: 'riot-route-dispatch-ack'\r\n  }\r\n};\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class RouteStore extends StoreBase {\r\n\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    riot.observable(this);\r\n\r\n    this.postResetRoute = null;\r\n    this.riotHandlers = [\r\n      {event: Constants.WELLKNOWN_EVENTS.in.routeDispatch, handler: this._onRouteDispatch},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.riotRouteLoadView, handler: this._onRiotRouteLoadView}\r\n    ];\r\n    this.bindEvents();\r\n  }\r\n  _onRouteDispatch(route, force) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.routeDispatch, route);\r\n    let current = riot.route.currentPath();\r\n\r\n    let same = current === route;\r\n\r\n    if (!same) {\r\n      same = ('/' + current) === route;\r\n    }\r\n    if (!same) {\r\n      riot.route(route);\r\n    } else {\r\n      if (force) {\r\n        riot.route.exec();\r\n      }\r\n    }\r\n\r\n    riot.routeState.route = route;\r\n    this.trigger(Constants.WELLKNOWN_EVENTS.out.routeDispatchAck, route);\r\n  }\r\n\r\n  _onRiotRouteLoadView(view) {\r\n    console.log(Constants.NAME, 'riot-route-load-view', view);\r\n    riot.router.loadView(view);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/route-store.js","export default class Validator {\r\n  static validateType(obj, type, name) {\r\n    if (!obj) {\r\n      throw new Error(name + ': is NULL');\r\n    }\r\n    if (!(obj instanceof type)) {\r\n      throw new Error(name + ': is NOT of type:' + type.name);\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/utils/validators.js","// http://www.javascriptkit.com/javatutors/loadjavascriptcss.shtml\r\n\r\n/*\r\ncomponent:{\r\n\t\tkey:'typicode-component',\r\n\t\tpath:'/partial/bundle.js',\r\n\t\ttype:'js'\r\n\t}\r\n\tor when unloading\r\ncomponent:{\r\n\t\tkey:'typicode-component'\r\n\t}\r\n\r\nevents:{\r\n\tout:[\r\n\t\t{\r\n\t\t\tevent:'load-external-jscss-ack',\r\n\t\t\ttype:'riotcontrol'\r\n\t\t\tdata:[\r\n\t\t\t\t{\r\n\t\t\t    \tstate:true,\r\n\t\t\t    \tcomponent:component\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t    \tstate:false,\r\n\t\t\t    \tcomponent:component,\r\n\t\t\t    \terror:\"component already added!\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t{\r\n\t\t\tevent:'unload-external-jscss-ack',\r\n\t\t\ttype:'riotcontrol'\r\n\t\t\tdata:[\r\n\t\t\t\t{\r\n\t\t\t    \tstate:true,\r\n\t\t\t    \tcomponent:component\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t    \tstate:false,\r\n\t\t\t    \tcomponent:component,\r\n\t\t\t    \terror:\"no entry found to remove!\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t}\r\n\r\n\t]\r\n\r\n}\r\n\r\n\t*/\r\nimport DeepFreeze from './utils/deep-freeze.js';\r\n\r\nclass Constants {}\r\nConstants.NAME = 'dynamic-jscss-loader';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n\r\n  },\r\n  out: {\r\n\r\n  }\r\n};\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class DynamicJsCssLoader {\r\n\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n\r\n  constructor() {\r\n    riot.observable(this);\r\n    this._componentsAddedSet = new Set();\r\n    this._bound = false;\r\n  }\r\n\r\n  _addComponent(component) {\r\n    if (this._findComponent(component) == null) {\r\n      let mySet = this._componentsAddedSet;\r\n\r\n      mySet.add(component);\r\n    }\r\n  }\r\n\r\n  _findComponent(component) {\r\n    let mySet = this._componentsAddedSet;\r\n\r\n    for (let item of mySet) {\r\n      if (item.key === component.key) {return item;}\r\n    }\r\n    return null;\r\n  }\r\n\r\n  _deleteComponent(component) {\r\n    let mySet = this._componentsAddedSet;\r\n\r\n    for (let item of mySet) {\r\n      if (item.key === component.key) {\r\n        mySet.delete(item);\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  loadExternalJsCss(component) {\r\n    let addedCompoment = this._findComponent(component);\r\n\r\n    if (addedCompoment == null) {\r\n      this._loadExternalJsCss(component);\r\n      this._addComponent(component);\r\n      console.log('load-external-jscss', component);\r\n    } else {\r\n      console.error('file already added!', component);\r\n    }\r\n  }\r\n\r\n  _removeExternalByFile(filename, filetype) {\r\n    // determine element type to create nodelist from\r\n    let targetelement = (filetype === 'js') ? 'script' : (filetype === 'css') ? 'link' : 'none';\r\n    // determine corresponding attribute to test for\r\n    let targetattr = (filetype === 'js') ? 'src' : (filetype === 'css') ? 'href' : 'none';\r\n    let allsuspects = document.getElementsByTagName(targetelement);\r\n\r\n    for (let i = allsuspects.length; i >= 0; i--) { // search backwards within nodelist for matching elements to remove\r\n      if (allsuspects[i] \t&&\r\n        allsuspects[i].getAttribute(targetattr) != null \t&&\r\n        allsuspects[i].getAttribute(targetattr).indexOf(filename) !== -1) {\r\n        allsuspects[i].parentNode.removeChild(allsuspects[i]); // remove element by calling parentNode.removeChild()\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  unloadExternalJsCss(component) {\r\n    let addedCompoment = this._findComponent(component);\r\n\r\n    if (addedCompoment != null) {\r\n      let jsBundle = component.jsBundle;\r\n      let cssBundle = component.cssBundle;\r\n\r\n      if (jsBundle && jsBundle.path) {\r\n        this._removeExternalByFile(jsBundle.path, 'js');\r\n      }\r\n      if (cssBundle && cssBundle.path) {\r\n        this._removeExternalByFile(cssBundle.path, 'css');\r\n      }\r\n      this._deleteComponent(component);\r\n    }\r\n  }\r\n\r\n  _preFetchExternalJsCss(component) {\r\n    let jsBundle = component.jsBundle;\r\n    let cssBundle = component.cssBundle;\r\n\r\n    if (jsBundle && jsBundle.path) {\r\n      let fileref = document.createElement('link');\r\n\r\n      fileref.setAttribute('rel', 'prefetch');\r\n      fileref.setAttribute('href', jsBundle.path);\r\n      if (typeof fileref !== 'undefined') {\r\n        document.getElementsByTagName('head')[0].appendChild(fileref);\r\n      }\r\n    }\r\n    if (cssBundle && cssBundle.path) {\r\n      let fileref = document.createElement('link');\r\n\r\n      fileref.setAttribute('rel', 'prefetch');\r\n      fileref.setAttribute('href', cssBundle.path);\r\n      if (typeof fileref !== 'undefined') {\r\n        document.getElementsByTagName('head')[0].appendChild(fileref);\r\n      }\r\n    }\r\n  }\r\n\r\n  _loadExternalJsCss(component) {\r\n    let jsBundle = component.jsBundle;\r\n    let cssBundle = component.cssBundle;\r\n\r\n    if (jsBundle && jsBundle.path) {\r\n      let fileref = document.createElement('script');\r\n\r\n      fileref.setAttribute('type', 'text/javascript');\r\n      fileref.setAttribute('src', jsBundle.path);\r\n      if (typeof fileref !== 'undefined') {\r\n        document.getElementsByTagName('head')[0].appendChild(fileref);\r\n      }\r\n    }\r\n    if (cssBundle && cssBundle.path) {\r\n      let fileref = document.createElement('link');\r\n\r\n      fileref.setAttribute('rel', 'stylesheet');\r\n      fileref.setAttribute('type', 'text/css');\r\n      fileref.setAttribute('href', cssBundle.path);\r\n      if (typeof fileref !== 'undefined') {\r\n        document.getElementsByTagName('head')[0].appendChild(fileref);\r\n      }\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/dynamic-jscss-loader.js","import DeepFreeze from './utils/deep-freeze.js';\r\n\r\nclass Constants {}\r\nConstants.NAME = 'router';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {},\r\n  out: {}\r\n};\r\n\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class Router {\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n  constructor() {\r\n    // we need this to easily check the current route from every component\r\n    riot.routeState.view = '';\r\n    this.r = riot.route.create();\r\n    this.resetCatchAll();\r\n  }\r\n\r\n  resetCatchAll() {\r\n    this.r.stop();\r\n    let mySet = riot.state.registeredPlugins;\r\n\r\n    for (let item of mySet) {\r\n      if (item.registrants && item.registrants.routeContributer) {\r\n        item.registrants.routeContributer.contributeRoutes(this.r);\r\n      }\r\n    }\r\n    this._contributeCatchAllRoute(this.r);\r\n  }\r\n\r\n  _contributeCatchAllRoute(r) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.contributeCatchAllRoute, r);\r\n    if (riot.state.componentLoaderState && riot.state.componentLoaderState.components) {\r\n      for (let item of riot.state.componentLoaderState.components) {\r\n        let component = item[1];\r\n\r\n        if (component.state.loaded === false) {\r\n          r(component.routeLoad.route, ()=>{\r\n            console.log('catchall route handler of:', component.routeLoad.route);\r\n\r\n            let path = riot.route.currentPath();\r\n\r\n            this.postResetRoute = path;\r\n            riot.control.trigger(riot.EVT.componentLoaderStore.in.loadDynamicComponent, component.key);\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    r('/..', ()=>{\r\n      console.log('route handler of /  ');\r\n      riot.control.trigger(riot.EVT.routeStore.in.routeDispatch, riot.state.route.defaultRoute);\r\n    });\r\n    if (this.postResetRoute != null) {\r\n      let postResetRoute = this.postResetRoute;\r\n\r\n      this.postResetRoute = null;\r\n      riot.control.trigger('riot-route-dispatch', postResetRoute, true);\r\n    }\r\n  }\r\n\r\n  loadView(view) {\r\n    if (this._currentView) {\r\n      this._currentView.unmount(true);\r\n    }\r\n    riot.routeState.view = view;\r\n    this._currentView = riot.mount('#riot-app', view)[0];\r\n  }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/router.js","/*\r\n\r\nvar testComponent = {\r\n  \"components\": [{\r\n    \"key\": \"typicode-component\",\r\n    \"jsBundle\": {\r\n      \"path\": \"/partial/typicode_component/bundle.js\"\r\n    },\r\n    \"cssBundle\": {\r\n      \"path\": \"/partial/typicode_component/styles.css\"\r\n    },\r\n\r\n    \"trigger\": {\r\n      \"onLoad\": [{\r\n        \"event\": \"SidebarStore:sidebar-add-item\",\r\n        \"data\": {\r\n          \"title\": \"My Components Page\",\r\n          \"route\": \"my-component-page/home\"\r\n        }\r\n      }],\r\n      \"onUnload\": [{\r\n        \"event\": \"SidebarStore:sidebar-remove-item\",\r\n        \"data\": {\r\n          \"title\": \"My Components Page\"\r\n        }\r\n      }, {\r\n        \"event\": \"plugin-unregistration\",\r\n        \"data\": {\r\n          \"name\": \"typicode-component\"\r\n        }\r\n      }]\r\n    },\r\n    \"routeLoad\": {\r\n      \"route\": \"/my-component-page..\"\r\n    },\r\n    \"state\": {\r\n      \"loaded\": false\r\n    }\r\n  }]\r\n};\r\n\r\nriot.control.trigger('init-component-loader-store');\r\nriot.control.trigger('add-dynamic-component',testComponent);\r\n\r\n*/\r\nimport DeepFreeze from '../utils/deep-freeze.js';\r\nimport Validator from '../utils/validators.js';\r\nimport DynamicJsCssLoader from '../dynamic-jscss-loader.js';\r\nimport StoreBase from './store-base.js';\r\n\r\nclass Constants {}\r\nConstants.NAME = 'component-loader-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n    addDynamicComponent: 'add-dynamic-component',\r\n    addDynamicComponents: 'add-dynamic-components',\r\n    loadDynamicComponent: 'load-dynamic-component',\r\n    unloadDynamicComponent: 'unload-dynamic-component',\r\n\r\n    pluginRegistered: 'plugin-registered',\r\n    pluginUnregistered: 'plugin-unregistered'\r\n\r\n  },\r\n  out: {\r\n    allComponentsLoadComplete: 'all-components-load-complete',\r\n    componentLoaderStoreStateUpdated: 'component-loader-store-state-updated'\r\n  }\r\n};\r\n\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class ComponentLoaderStore extends StoreBase {\r\n\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n\r\n  constructor(dynamicJsCssLoader) {\r\n    super();\r\n    Validator.validateType(dynamicJsCssLoader, DynamicJsCssLoader, 'dynamicJsCssLoader');\r\n    this.dynamicJsCssLoader = dynamicJsCssLoader;\r\n\r\n    riot.observable(this);\r\n    this._components = new Set();\r\n    riot.state.componentLoaderState = {};\r\n    this.state = riot.state.componentLoaderState;\r\n\r\n    this.riotHandlers = [\r\n      {event: Constants.WELLKNOWN_EVENTS.in.loadDynamicComponent, handler: this._onLoadDynamicComponent},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.unloadDynamicComponent, handler: this._onUnloadDymanicComponent},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.addDynamicComponent, handler: this._onAddDynamicComponent},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.addDynamicComponents, handler: this._onAddDynamicComponents},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.pluginRegistered, handler: this._onPluginRegistered},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.pluginUnregistered, handler: this._onPluginUnregistered}\r\n    ];\r\n    this.bindEvents();\r\n  }\r\n\r\n  _commitToState() {\r\n\r\n    var componentsArray = Array.from(this._components);\r\n\r\n    this.state.components = new Map(componentsArray.map((i) => [i.key, i]));\r\n    this.trigger(Constants.WELLKNOWN_EVENTS.out.componentLoaderStoreStateUpdated);\r\n  }\r\n  _addComponent(component) {\r\n\r\n    if (this._findComponent(component.key) == null) {\r\n      this._components.add(component);\r\n      this.dynamicJsCssLoader._preFetchExternalJsCss(component);\r\n      this._commitToState();\r\n    }\r\n  }\r\n  _findComponent(key) {\r\n\r\n    for (let item of this._components) {\r\n      if (item.key === key) {\r\n        return item;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n  _onPluginRegistered(registration) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.pluginRegistered, registration);\r\n    let component = this._findComponent(registration.name);\r\n\r\n    if (component) {\r\n      for (let triggerItem of component.trigger.onLoad) {\r\n        riot.control.trigger(triggerItem.event, triggerItem.data);\r\n      }\r\n      component.state.loaded = true;\r\n      this.trigger(Constants.WELLKNOWN_EVENTS.out.componentLoaderStoreStateUpdated);\r\n    }\r\n  }\r\n  _onPluginUnregistered(registration) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.pluginUnregistered, registration);\r\n    let component = this._findComponent(registration.name);\r\n\r\n    if (component) {\r\n      for (let triggerItem of component.trigger.onUnload) {\r\n        riot.control.trigger(triggerItem.event, triggerItem.data);\r\n      }\r\n      component.state.loaded = false;\r\n      this.trigger(Constants.WELLKNOWN_EVENTS.out.componentLoaderStoreStateUpdated);\r\n    }\r\n  }\r\n\r\n  _onAddDynamicComponent(component) {\r\n\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.addDynamicComponent, component);\r\n    let comp = this._findComponent(component.key);\r\n\r\n    if (comp == null) {\r\n      this._addComponent(component);\r\n\r\n      if (this._allLoadedCompleteCheck() === true) {\r\n                // need to trigger a load complete just on a simple add so that auto route loading can work\r\n        riot.control.trigger(Constants.WELLKNOWN_EVENTS.out.allComponentsLoadComplete);\r\n      }\r\n    }\r\n  }\r\n\r\n  _onAddDynamicComponents(components, ack) {\r\n\r\n    if (components) {\r\n      console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.addDynamicComponents, components);\r\n      for (let component of components) {\r\n        let comp = this._findComponent(component.key);\r\n\r\n        if (comp === null) {\r\n          this._addComponent(component);\r\n        }\r\n      }\r\n    }\r\n    riot.control.trigger(ack.evt, ack);\r\n  }\r\n\r\n  _onLoadDynamicComponent(key) {\r\n\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.loadDynamicComponent, key);\r\n    let component = this._findComponent(key);\r\n\r\n    if (component != null && component.state.loaded !== true) {\r\n      this.dynamicJsCssLoader.loadExternalJsCss(component);\r\n\r\n    }\r\n  }\r\n  _onUnloadDymanicComponent(key) {\r\n\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.unloadDynamicComponent, key);\r\n    let component = this._findComponent(key);\r\n\r\n    if (component != null && component.state.loaded === true) {\r\n      // need to cleanup the routes and stores before we can unload the JS.\r\n      // 1. plugin-registration-store first.\r\n\r\n      riot.control.trigger(riot.EVT.pluginRegistrationStore.in.pluginUnregistration, {\r\n        'name': key\r\n      });\r\n    }\r\n  }\r\n\r\n  _allLoadedCompleteCheck() {\r\n\r\n    var result = true;\r\n\r\n    for (let item of this._components) {\r\n      if (item.state.loaded === true && item.state.loadedComplete === false) {\r\n        result = false;\r\n        break;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/component-loader-store.js","/**\r\n * Created by Herb on 9/27/2016.\r\n */\r\nimport DeepFreeze from '../utils/deep-freeze.js';\r\nimport StoreBase from './store-base.js';\r\n\r\nclass Constants {}\r\nConstants.NAME = 'progress-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n    inprogressDone: Constants.NAMESPACE + 'inprogress-done',\r\n    inprogressStart: Constants.NAMESPACE + 'inprogress-start'\r\n  },\r\n  out: {\r\n    progressStart: Constants.NAMESPACE + 'progress-start',\r\n    progressCount: Constants.NAMESPACE + 'progress-count',\r\n    progressDone: Constants.NAMESPACE + 'progress-done'\r\n  }\r\n};\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class ProgressStore extends StoreBase {\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n  constructor() {\r\n    super();\r\n    riot.observable(this);\r\n    this._count = 0;\r\n    this.riotHandlers = [\r\n      {event: Constants.WELLKNOWN_EVENTS.in.inprogressStart, handler: this._onInProgressStart},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.inprogressDone, handler: this._onInProgressDone}\r\n    ];\r\n    this.bindEvents();\r\n  }\r\n\r\n  _onInProgressStart() {\r\n    if (this._count === 0) {\r\n      this.trigger(Constants.WELLKNOWN_EVENTS.out.progressStart);\r\n    }\r\n    ++this._count;\r\n    this.trigger(Constants.WELLKNOWN_EVENTS.out.progressCount, this._count);\r\n  }\r\n  _onInProgressDone() {\r\n    if (this.count === 0) {\r\n            // very bad.\r\n      console.error(Constants.WELLKNOWN_EVENTS.in.inprogressDone,\r\n                'someone has their inprogress_done mismatched with thier inprogress_start');\r\n    }\r\n    if (this._count > 0) {\r\n      --this._count;\r\n    }\r\n    this.trigger(Constants.WELLKNOWN_EVENTS.out.progressCount, this._count);\r\n    if (this._count === 0) {\r\n      this.trigger(Constants.WELLKNOWN_EVENTS.out.progressDone);\r\n    }\r\n  }\r\n\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/progress-store.js","export default class RandomString {\r\n  constructor() {\r\n    var self = this;\r\n\r\n    self.name = 'RandomString';\r\n    self.namespace = self.name + ':';\r\n    self.generateRandomString = (length) =>{\r\n      if (length && length > 16) {\r\n        length = 16;\r\n      } else {\r\n        length = 16;\r\n      }\r\n\r\n      let text = '';\r\n      let possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n\r\n      for (let i = 0; i < length; i++) {\r\n        text += possible.charAt(Math.floor(Math.random() * possible.length));\r\n      }\r\n      return text;\r\n    };\r\n    self.hashString = (str) =>{\r\n      let hash = 5381;\r\n      let i = str.length;\r\n\r\n      while (i) {\r\n        hash = (hash * 33) ^ str.charCodeAt(--i);\r\n      }\r\n/* JavaScript does bitwise operations (like XOR, above) on 32-bit signed\r\n* integers. Since we want the results to be always positive, convert the\r\n* signed int to an unsigned by doing an unsigned bitshift. */\r\n      return hash >>> 0;\r\n    };\r\n    self.randomHash = (length) =>{\r\n      return self.hashString(self.generateRandomString(length));\r\n    };\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/utils/random-string.js","import DeepFreeze from './utils/deep-freeze.js';\r\n\r\nclass Constants {}\r\nConstants.NAME = 'riotcontrol-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {},\r\n  out: {}\r\n};\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class RiotControlExt {\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n  constructor() {\r\n    riot.observable(this);\r\n    this._bound = false;\r\n    this._stores = {};\r\n  }\r\n  add(name, store) {\r\n    this._stores[name] = store;\r\n    riot.control.addStore(store);\r\n  }\r\n  remove(name) {\r\n    let store = this._stores[name];\r\n\r\n    while (riot.control._stores.indexOf(store) !== -1) {\r\n      riot.control._stores.splice(riot.control._stores.indexOf(store), 1);\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/riotcontrol-ext.js","\r\nimport DeepFreeze from '../utils/deep-freeze.js';\r\nimport RouteStore from './route-store.js';\r\nimport StoreBase from './store-base.js';\r\n\r\nconst RSWKE = RouteStore.constants.WELLKNOWN_EVENTS;\r\n\r\nclass Constants {}\r\nConstants.NAME = 'error-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n    errorCatchAll: Constants.NAMESPACE + 'catch-all:'\r\n  },\r\n  out: {\r\n    routeDispatch: RSWKE.in.routeDispatch\r\n  }\r\n};\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class ErrorStore extends StoreBase {\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n    riot.observable(this);\r\n    this._bound = false;\r\n    this._error = {};\r\n    this.riotHandlers = [\r\n      {event: Constants.WELLKNOWN_EVENTS.in.errorCatchAll, handler: this._onError}\r\n    ];\r\n    this.bindEvents();\r\n  }\r\n\r\n  _onError(error) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.errorCatchAll, error);\r\n    this._error = error;\r\n    riot.state.error = error;\r\n    riot.control.trigger(Constants.WELLKNOWN_EVENTS.out.routeDispatch, '/error');\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/error-store.js","/**\r\n * Created by Herb on 9/27/2016.\r\n */\r\nimport 'whatwg-fetch';\r\nimport DeepFreeze from '../utils/deep-freeze.js';\r\nimport ProgressStore from './progress-store.js';\r\nimport StoreBase from './store-base.js';\r\n\r\nconst PSWKE = ProgressStore.constants.WELLKNOWN_EVENTS;\r\n\r\nclass Constants {}\r\nConstants.NAME = 'fetch-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n    fetch: Constants.NAMESPACE + 'fetch'\r\n  },\r\n  out: {\r\n    inprogressDone: PSWKE.in.inprogressDone,\r\n    inprogressStart: PSWKE.in.inprogressStart\r\n  }\r\n};\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class FetchStore extends StoreBase {\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n  constructor() {\r\n    super();\r\n    riot.observable(this);\r\n    this.riotHandlers = [\r\n      {event: Constants.WELLKNOWN_EVENTS.in.fetch, handler: this._onFetch}\r\n    ];\r\n    this.bindEvents();\r\n  }\r\n\r\n  _onLocalFetch(input, ack) {\r\n    console.log(Constants.WELLKNOWN_EVENTS.in.fetch, '_onLocalFetch', input, ack, window.boundAsync);\r\n    if (window.boundAsync) {\r\n      let result = { response: {}};\r\n\r\n      let url = window.location.origin;\r\n      let frontPath = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/') + 1);\r\n\n      url += frontPath;\r\n      url += input;\r\n\r\n      window.boundAsync.fetchLocal(url).then(function (data) {\r\n        result.json = JSON.parse(data);\r\n        console.log(result.json);\r\n        result.error = null;\r\n        result.response.ok = true;\r\n        riot.control.trigger(ack.evt, result, ack);\r\n      });\r\n    }\r\n  }\r\n\r\n  _onFetch(input, init, ack, antiforgery = null, jsonFixup = true) {\r\n    console.log(Constants.WELLKNOWN_EVENTS.in.fetch, input, init, ack, jsonFixup);\r\n\r\n    if (window.location.protocol === 'localfolder:' && !input.startsWith('http')) {\r\n      this._onLocalFetch(input, ack);\r\n      return;\r\n    }\r\n    riot.control.trigger(riot.EVT.fetchStore.out.inprogressStart);\r\n    if (jsonFixup === true) {\r\n      if (!antiforgery) {\r\n        antiforgery = {\r\n          cookieName: 'XSRF-TOKEN',\r\n          headerName: 'X-XSRF-TOKEN'\r\n        };\r\n      }\r\n      let token = riot.Cookies.get(antiforgery.cookieName);\r\n\r\n      if (!init) {\r\n        init = {};\r\n      }\r\n      if (!init.headers) {\r\n        init.headers = {};\r\n      }\r\n\r\n      if (token) {\r\n        init.headers[antiforgery.headerName] = token;\r\n      }\r\n\r\n      if (!init.credentials) {\r\n        init.credentials = 'include';\r\n      }\r\n      // we are a json shop\r\n      if (!init.headers['Content-Type']) {\r\n        init.headers['Content-Type'] = 'application/json';\r\n      }\r\n\r\n      if (!init.headers['Accept']) {\r\n        init.headers['Accept'] = 'application/json';\r\n      }\r\n\r\n      if (init.body) {\r\n        let type = typeof (init.body);\r\n\r\n        if (type === 'object') {\r\n          init.body = JSON.stringify(init.body);\r\n        }\r\n      }\r\n    }\r\n\r\n //   let myTrigger = JSON.parse(JSON.stringify(ack));\r\n\r\n    fetch(input, init).then(function (response) {\r\n      riot.control.trigger(riot.EVT.fetchStore.out.inprogressDone);\r\n      let result = {response: response};\r\n\r\n      if (response.status === 204) {\r\n        result.error = 'Fire the person that returns this 204 garbage!';\r\n        riot.control.trigger(ack.evt, result, ack);\r\n      }\r\n      if (response.ok) {\r\n        if (init.method === 'HEAD') {\r\n          riot.control.trigger(ack.evt, result, ack);\r\n        } else {\r\n          response.json().then((data)=>{\r\n            console.log(data);\r\n            result.json = data;\r\n            result.error = null;\r\n            riot.control.trigger(ack.evt, result, ack);\r\n          });\r\n        }\r\n      } else {\r\n        riot.control.trigger(ack.evt, result, ack);\r\n      }\r\n    }).catch(function (ex) {\r\n      console.log('fetch failed', ex);\r\n      self.error = ex;\r\n            // todo: event out error to ack\r\n      riot.control.trigger(riot.EVT.fetchStore.out.inprogressDone);\r\n    });\r\n  }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/fetch-store.js","import DeepFreeze from '../utils/deep-freeze.js';\r\nimport StoreBase from './store-base.js';\r\nimport RouteStore from './route-store.js';\r\n\r\nconst RSWKE = RouteStore.constants.WELLKNOWN_EVENTS;\r\n\r\nclass Constants {}\r\nConstants.NAME = 'history-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n    errorCatchAll: Constants.NAMESPACE + 'catch-all:'\r\n  },\r\n  out: {\r\n    routeDispatch: RSWKE.in.routeDispatch\r\n  }\r\n};\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class HistoryStore extends StoreBase {\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n\r\n  constructor() {\r\n    super();\r\n\r\n    let self = this;\r\n\r\n    riot.observable(this);\r\n    this._bound = false;\r\n    this._error = {};\r\n    this.riotHandlers = [\r\n      {event: Constants.WELLKNOWN_EVENTS.in.errorCatchAll, handler: this._onError}\r\n    ];\r\n    this.bindEvents();\r\n    window.onpopstate = (event) =>{\r\n      self._onPopState(event);\r\n    };\r\n  }\r\n\r\n  _onError(error) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.errorCatchAll, error);\r\n    this._error = error;\r\n    riot.state.error = error;\r\n    riot.control.trigger(Constants.WELLKNOWN_EVENTS.out.routeDispatch, '/error');\r\n  }\r\n  _onPopState(event) {\r\n    console.log(Constants.NAME, 'location: ' + document.location + ', state: ', event.state);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/history-store.js","import DeepFreeze from '../utils/deep-freeze.js';\r\nimport StoreBase from './store-base.js';\r\n\r\nclass Constants {}\r\nConstants.NAME = 'keep-alive-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n    fetchHeadResult: Constants.NAMESPACE + 'fetch-head-result',\r\n    enable: Constants.NAMESPACE + 'enable',\r\n    disable: Constants.NAMESPACE + 'disable'\r\n  },\r\n  out: {\r\n    keptAlive: Constants.NAMESPACE + 'kept-alive'\r\n  }\r\n};\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class KeepAliveStore extends StoreBase {\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n  constructor() {\r\n    super();\r\n    let self = this;\r\n\r\n    riot.observable(this);\r\n    this.riotHandlers = [\r\n      {event: Constants.WELLKNOWN_EVENTS.in.fetchHeadResult, handler: this._onFetchHeadResult},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.enable, handler: this._onEnable},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.disable, handler: this._onDisable}\r\n    ];\r\n    self.bindEvents();\r\n    self._keepAlive = false;\r\n  }\r\n\r\n  _onEnable() {\r\n    let self = this;\r\n    let w = riot.global.window;\r\n\r\n    w._oldOpen = XMLHttpRequest.prototype.open;\r\n    let onStateChange = (event) =>{\r\n      if (event.currentTarget.readyState === 4) {\r\n        self._onHttpMonitor(event.currentTarget.responseURL, event.currentTarget.status);\r\n      }\r\n    };\r\n\r\n    XMLHttpRequest.prototype.open = () =>{\r\n        // when an XHR object is opened, add a listener for its readystatechange events\r\n      this.addEventListener('readystatechange', onStateChange);\r\n        // run the real `open`\r\n      w._oldOpen.apply(this, arguments);\r\n    };\r\n\r\n    if (!w.fetch.polyfill) {\r\n      w._oldFetch = w.fetch;\r\n\r\n      w.fetch = (input, init) =>{\r\n        return w._oldFetch(input, init).then(response =>{\r\n          self._onHttpMonitor(response.url, response.status);\r\n          return response;\r\n        });\r\n      };\r\n    }\r\n\r\n    self.timer = setInterval(()=>{\r\n      self._onTimer();\r\n    }, 5000);\r\n\r\n  }\r\n\r\n  _onDisable() {\r\n    let self = this;\r\n    let w = riot.global.window;\r\n\r\n    if (self.timer) {\r\n      clearInterval(this.timer);\r\n    }\r\n\r\n    if (w._oldFetch) {\r\n      w.fetch = w._oldFetch;\r\n      w._oldFetch = null;\r\n    }\r\n    if (w._oldOpen) {\r\n      XMLHttpRequest.prototype.open = w._oldOpen;\r\n      w._oldOpen = null;\r\n    }\r\n  }\r\n\r\n  _onHttpMonitor(url, status) {\r\n    let n = url.startsWith(window.location.origin);\r\n\r\n    if (n === false) {\r\n      this._keepAlive = true;\r\n    }\r\n  }\r\n  _onTimer() {\r\n    if (this._keepAlive) {\r\n      this._keepAlive = false;\r\n      let myAck = {\r\n        evt: Constants.WELLKNOWN_EVENTS.in.fetchHeadResult\r\n      };\r\n\r\n      riot.control.trigger(riot.EVT.fetchStore.in.fetch, riot.state.keepAlive.url,\r\n                                {method: 'HEAD'}, myAck);\r\n    }\r\n  }\r\n  _onFetchHeadResult(result, ack) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.fetchHeadResult,\r\n      result, ack);\r\n    this.trigger(Constants.WELLKNOWN_EVENTS.out.keptAlive);\r\n  }\r\n\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/keep-alive-store.js","/**\r\n * Created by Herb on 9/27/2016.\r\n */\r\nimport DeepFreeze from '../utils/deep-freeze.js';\r\nimport StoreBase from './store-base.js';\r\n\r\nclass Constants {}\r\nConstants.NAME = 'localstorage-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n    localstorageSet: Constants.NAMESPACE + 'set',\r\n    localstorageGet: Constants.NAMESPACE + 'get',\r\n    localstorageRemove: Constants.NAMESPACE + 'remove',\r\n    localstorageClear: Constants.NAMESPACE + 'clear'\r\n  },\r\n  out: {}\r\n};\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class LocalStorageStore extends StoreBase {\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n  constructor() {\r\n    super();\r\n    riot.observable(this);\r\n    this.riotHandlers = [\r\n      {event: Constants.WELLKNOWN_EVENTS.in.localstorageSet, handler: this._onSet},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.localstorageGet, handler: this._onGet},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.localstorageRemove, handler: this._onRemove},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.localstorageClear, handler: this._onClear}\r\n    ];\r\n    this.bindEvents();\r\n  }\r\n\r\n    /*\r\n    {\r\n        key:[string:required],\r\n        data: [Object],\r\n        trigger:[optional]{\r\n            event:[string],\r\n            riotControl:bool  // do a riotcontrol.trigger or just an observable trigger.\r\n        }\r\n    }\r\n    */\r\n  _onSet(query) {\r\n    console.log(Constants.WELLKNOWN_EVENTS.in.localstorageSet, query);\r\n    localStorage.setItem(query.key, JSON.stringify(query.data));\r\n    if (query.trigger) {\r\n      this.trigger(query.trigger); // in case you want an ack\r\n    }\r\n  }\r\n     /*\r\n        {\r\n            key:'myKey',\r\n            trigger:{\r\n                    event:[string],\r\n                    riotControl:bool  // do a riotcontrol.trigger or just an observable trigger.\r\n             }\r\n        }\r\n    */\r\n  _onGet(query) {\r\n    console.log(Constants.WELLKNOWN_EVENTS.in.localstorageGet, query);\r\n    let stored = localStorage.getItem(query.key);\r\n    let data = null;\r\n\r\n    if (stored && stored !== 'undefined') {\r\n      data = JSON.parse(stored);\r\n    }\r\n    if (query.trigger.riotControl === true) {\r\n      riot.control.trigger(query.trigger.event, data);\r\n    } else {\r\n      this.trigger(query.trigger.event, data);\r\n    }\r\n  }\r\n    /*\r\n     {\r\n     key:'myKey'\r\n     }\r\n     */\r\n  _onRemove(query) {\r\n    console.log(Constants.WELLKNOWN_EVENTS.in.localstorageRemove, query);\r\n    localStorage.removeItem(query.key);\r\n  }\r\n\r\n  _onClear() {\r\n    console.log(Constants.WELLKNOWN_EVENTS.in.localstorageClear);\r\n    localStorage.clear();\r\n  }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/localstorage-store.js","\r\n/*\r\nvar registerRecord = {\r\n  name:'riotjs-partial-spa',\r\n  views:[\r\n    {view:'my-component-page'},\r\n    {view:'typicode-user-detail'}\r\n  ],\r\n  stores:[\r\n    {store: new TypicodeUserStore()}\r\n  ],\r\n  postLoadEvents:[\r\n    {event:'typicode-init',data:{}}\r\n  ],\r\n  preUnloadEvents:[\r\n    {event:'typicode-uninit',data:{}}\r\n  ]\r\n};\r\nriot.control.trigger('plugin-registration',registerRecord);\r\n\r\n*/\r\nimport DeepFreeze from '../utils/deep-freeze.js';\r\nimport Validator from '../utils/validators.js';\r\nimport RiotControlExt from '../riotcontrol-ext.js';\r\nimport '../router.js';\r\nimport DynamicJsCssLoader from '../dynamic-jscss-loader.js';\r\nimport ComponentLoaderStore from './component-loader-store.js';\r\nimport StoreBase from './store-base.js';\r\n\r\nclass Constants {}\r\nConstants.NAME = 'plugin-registration-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n    pluginRegistration: 'plugin-registration',\r\n    pluginUnregistration: 'plugin-unregistration'\r\n  },\r\n  out: {\r\n    pluginRegistered: 'plugin-registered',\r\n    pluginUnregistered: 'plugin-unregistered'\r\n  }\r\n};\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class PluginRegistrationStore extends StoreBase {\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n\r\n  constructor(riotControlExt, dynamicJsCssLoader, componentLoaderStore) {\r\n    super();\r\n    Validator.validateType(riotControlExt, RiotControlExt, 'riotControlExt');\r\n    Validator.validateType(dynamicJsCssLoader, DynamicJsCssLoader, 'dynamicJsCssLoader');\r\n    Validator.validateType(componentLoaderStore, ComponentLoaderStore, 'componentLoaderStore');\r\n\r\n    riot.observable(this);\r\n    this.riotControlExt = riotControlExt;\r\n    this.dynamicJsCssLoader = dynamicJsCssLoader;\r\n    this.componentLoaderStore = componentLoaderStore;\r\n\r\n    this.riotHandlers = [\r\n      {event: Constants.WELLKNOWN_EVENTS.in.pluginRegistration, handler: this._registerPlugin},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.pluginUnregistration, handler: this._unregisterPlugin}\r\n    ];\r\n    this.bindEvents();\r\n    riot.state.registeredPlugins = new Set();\r\n\r\n  }\r\n\r\n  _findRegistration(registrationName) {\r\n\r\n    var mySet = riot.state.registeredPlugins;\r\n\r\n    for (let item of mySet) {\r\n      if (item.name === registrationName) {return item;}\r\n    }\r\n    return null;\r\n  }\r\n  _removeRegistration(registrationName) {\r\n\r\n    var mySet = riot.state.registeredPlugins;\r\n\r\n    for (let item of mySet) {\r\n      if (item.name === registrationName) {\r\n        mySet.delete(item);\r\n        break;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  _registerPlugin(registration) {\r\n\r\n    let foundRegistration = this._findRegistration(registration.name);\r\n\r\n    if (foundRegistration === null) {\r\n\r\n      // 1. Add the registration record\r\n      riot.state.registeredPlugins.add(registration);\r\n\r\n      // 2. Ready up the stores\r\n      for (let i = 0; i < registration.stores.length; i++) {\r\n\r\n        // 2.1 Tell the stores to START listening.  Doing a bind, which may not be neccessary\r\n        //    but it has to match the unbind that I am doing later in the unregister.\r\n        //    It is required to be implemented, even if it is a noop.\r\n        registration.stores[i].store.bindEvents();\r\n\r\n        // 2.2 Add the stores\r\n        registration.stores[i].name = registration.name + '-store-' + i; // need this for my own tracking\r\n        this.riotControlExt.add(registration.stores[i].name, registration.stores[i].store);\r\n      }\r\n\r\n      // 3. fire post load events\r\n      //    NOTE: we do NOT fire unload events as they are async and these stores have to go\r\n      for (let i = 0; i < registration.postLoadEvents.length; i++) {\r\n        riot.control.trigger(registration.postLoadEvents[i].event, registration.postLoadEvents[i].data);\r\n      }\r\n\r\n      // 4. Rebuild the routes.\r\n      riot.router.resetCatchAll(); // this rebuilds the routes, without the above nulled one\r\n\r\n      // FINALLY. Tell the world that things have changed.\r\n      riot.control.trigger(Constants.WELLKNOWN_EVENTS.out.pluginRegistered, registration);\r\n    } else {\r\n      console.error(Constants.NAME, registration, 'plugin already registered!');\r\n    }\r\n  }\r\n\r\n  _unregisterPlugin(registration) {\r\n\r\n    var foundRegistration = this._findRegistration(registration.name);\r\n\r\n    if (foundRegistration === null) {\r\n      console.error(Constants.NAME, registration, 'plugin already unregistered!');\r\n    } else {\r\n      // 0. We do NOT fire unregister events as the stores will be gone before any event can reach them\r\n\r\n      // 1. Tell the router to drop all routes for this component.\r\n      let component = this.componentLoaderStore._findComponent(foundRegistration.name);\r\n\r\n      if (component && foundRegistration.registrants && foundRegistration.registrants.routeContributer) {\r\n        component.state.loaded = false;\r\n        foundRegistration.registrants.routeContributer = null;  // get rid of the contributer.\r\n        riot.router.resetCatchAll(); // this rebuilds the routes, without the above nulled one\r\n      }\r\n\r\n      // 2. Shutdown the stores\r\n      for (let i = 0; i < foundRegistration.stores.length; i++) {\r\n\r\n        // 2.1. Tell the store to STOP listening.\r\n        foundRegistration.stores[i].store.unbindEvents(); // stop listening\r\n\r\n        // 2.2. Remove the store.\r\n        this.riotControlExt.remove(foundRegistration.stores[i].name);\r\n      }\r\n\r\n      // 3. Unload the JSCSS stuff.\r\n      this.dynamicJsCssLoader.unloadExternalJsCss(component);\r\n\r\n      // 4. Remove the registration record\r\n      this._removeRegistration(foundRegistration.name);\r\n\r\n      // FINALLY. Tell the world that things have changed.\r\n      riot.control.trigger(Constants.WELLKNOWN_EVENTS.out.pluginUnregistered, registration);\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/plugin-registration-store.js","import DeepFreeze from '../utils/deep-freeze.js';\r\nimport StoreBase from './store-base.js';\r\n\r\nclass Constants {}\r\nConstants.NAME = 'riotcontrol-dispatch-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n    dispatch: Constants.NAMESPACE + 'dispatch'\r\n  },\r\n  out: {\r\n  }\r\n};\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class RiotControlDispatchStore extends StoreBase {\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n  constructor() {\r\n    super();\r\n    riot.observable(this);\r\n    this.riotHandlers = [\r\n      {event: Constants.WELLKNOWN_EVENTS.in.dispatch, handler: this._onDispatch}\r\n    ];\r\n    this.bindEvents();\r\n  }\r\n  _onDispatch(event, data) {\r\n    console.log(Constants.WELLKNOWN_EVENTS.in.dispatch, event, data);\r\n    this.trigger(event, data);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/riotcontrol-dispatch-store.js","import DeepFreeze from '../utils/deep-freeze.js';\r\nimport Router from '../router.js';\r\nimport StoreBase from './store-base.js';\r\n\r\nclass Constants {}\r\nConstants.NAME = 'startup-store';\r\nConstants.NAMESPACE = Constants.NAME + ':';\r\nConstants.WELLKNOWN_EVENTS = {\r\n  in: {\r\n    start: Constants.NAMESPACE + 'start',\r\n    fetchConfig: Constants.NAMESPACE + 'fetch-config',\r\n    fetchConfigResult: Constants.NAMESPACE + 'fetch-config-result',\r\n    fetchConfigResult2: Constants.NAMESPACE + 'fetch-config-result2',\r\n    componentsAdded: Constants.NAMESPACE + 'components-added'\r\n\r\n  },\r\n  out: {\r\n    configComplete: Constants.NAMESPACE + 'config-complete'\r\n  }\r\n};\r\n\r\nDeepFreeze.freeze(Constants);\r\n\r\nexport default class StartupStore extends StoreBase {\r\n  static get constants() {\r\n    return Constants;\r\n  }\r\n  constructor() {\r\n    super();\r\n    riot.observable(this);\r\n\r\n    this._startupComplete = false;\r\n    this._done = false;\r\n    this.riotHandlers = [\r\n      {event: Constants.WELLKNOWN_EVENTS.in.start, handler: this._onStart},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.fetchConfig, handler: this._onFetchConfig},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.fetchConfigResult2, handler: this._onFetchConfigResult2},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.fetchConfigResult, handler: this._onFetchConfigResult},\r\n      {event: Constants.WELLKNOWN_EVENTS.in.componentsAdded, handler: this._onComponentsAdded}\r\n    ];\r\n    this.bindEvents();\r\n  }\r\n\r\n  _onComponentsAdded(ack) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.componentsAdded, ack);\r\n    this.trigger(Constants.WELLKNOWN_EVENTS.out.configComplete);\r\n//    riot.control.trigger(ack.ack.evt, ack.ack);\r\n  }\r\n  _onFetchConfigResult(result, ack) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.fetchConfigResult, result, ack);\r\n    if (result.error || !result.response.ok) {\r\n      riot.control.trigger(riot.EVT.errorStore.in.errorCatchAll, {code: 'startup-config1234'});\r\n    } else {\r\n      riot.control.trigger(riot.EVT.componentLoaderStore.in.addDynamicComponents\r\n        , result.json.components, {evt: Constants.WELLKNOWN_EVENTS.in.componentsAdded});\r\n    }\r\n  }\r\n  _onFetchConfigResult2(result, ack) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.fetchConfigResult2,\r\n      result, ack);\r\n  }\r\n  _onFetchConfig(path) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.fetchConfig, path);\r\n    let url = path;\r\n    let myAck = {\r\n      evt: Constants.WELLKNOWN_EVENTS.in.fetchConfigResult\r\n    };\r\n    let myAck2 = {\r\n      evt: Constants.WELLKNOWN_EVENTS.in.fetchConfigResult2\r\n    };\r\n\r\n    riot.control.trigger(riot.EVT.fetchStore.in.fetch, url, {method: 'HEAD'}, myAck2);\r\n    riot.control.trigger(riot.EVT.fetchStore.in.fetch, url, null, myAck);\r\n  }\r\n  _onStart(nextTag) {\r\n    console.log(Constants.NAME, Constants.WELLKNOWN_EVENTS.in.start, this._done, nextTag);\r\n    if (this._done) {\r\n      return;\r\n    }\r\n\r\n    if (!nextTag) {\r\n      nextTag = 'app';\r\n    }\r\n    if (nextTag === 'app') {\r\n      this._done = true;\r\n      // only when the nextTag is 'app' do we engage the router.\r\n      // 'app' is last\r\n      riot.router = new Router();\r\n      riot.mount(nextTag);\r\n      riot.route.start(true);\r\n    } else {\r\n      riot.mount(nextTag);\r\n    }\r\n\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/stores/startup-store.js","module.exports = __WEBPACK_EXTERNAL_MODULE_18__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"riot\"\n// module id = 18\n// module chunks = 0","import 'riot';\r\nimport route from 'riot-route';\r\nimport Cookies from 'js-cookie';\r\nimport RiotControl from 'riotcontrol';\r\nimport RandomString from './utils/random-string.js';\r\nimport RiotRouteExtension from './extensions/riot-route-extension.js';\r\nimport ProgressStore from './stores/progress-store.js';\r\nimport DynamicJsCssLoader from './dynamic-jscss-loader.js';\r\nimport ComponentLoaderStore from './stores/component-loader-store.js';\r\nimport ErrorStore from './stores/error-store.js';\r\nimport HistoryStore from './stores/history-store.js';\r\nimport FetchStore from './stores/fetch-store.js';\r\nimport LocalStorageStore from './stores/localstorage-store.js';\r\nimport RiotControlExt from './riotcontrol-ext.js';\r\nimport RouteStore from './stores/route-store.js';\r\nimport PluginRegistrationStore from './stores/plugin-registration-store.js';\r\nimport StartupStore from './stores/startup-store.js';\r\nimport RiotControlDispatchStore from './stores/riotcontrol-dispatch-store.js';\r\nimport KeepAliveStore from './stores/keep-alive-store.js';\r\n\r\nimport MasterEventTable from './master-event-table.js';\r\nimport './components/startup.tag';\r\n\r\nriot.global = {};\r\nriot.Cookies = Cookies;\r\nexport default class P7HostCore {\r\n\r\n  constructor() {\r\n    this._masterEventTable = new MasterEventTable();\r\n    this._name = 'P7HostCore';\r\n    window.riot = riot;  // TODO: ask Zeke about this\r\n    riot.route = route;\r\n    riot.control = RiotControl;\r\n    riot.state = {};\r\n  }\r\n\r\n  get name() {\r\n    return this._name;\r\n  }\r\n\r\n  Initialize() {\r\n\r\n    riot.routeState = {};\r\n\r\n    let randomString = new RandomString();\r\n    let hash = randomString.randomHash();\r\n\r\n    riot.state = {\r\n      _internal: {\r\n        hash: hash\r\n      },\r\n      error: {code: 'unknown'},\r\n      route: {\r\n        defaultRoute: 'main/home'\r\n      }\r\n    };\r\n    this._riotRouteExtension = new RiotRouteExtension();\r\n\r\n    this._progressStore = new ProgressStore();\r\n    this._dynamicJsCssLoader = new DynamicJsCssLoader();\r\n    this._errorStore = new ErrorStore();\r\n    this._fetchStore = new FetchStore();\r\n    this._localStorageStore = new LocalStorageStore();\r\n    this._riotControlExt = new RiotControlExt();\r\n    this._routeStore = new RouteStore();\r\n    this._keepAliveStore = new KeepAliveStore();\r\n    this._historyStore = new HistoryStore();\r\n\r\n    this._componentLoaderStore = new ComponentLoaderStore(this._dynamicJsCssLoader);\r\n    this._pluginRegistrationStore = new PluginRegistrationStore(this._riotControlExt,\r\n                                                                    this._dynamicJsCssLoader,\r\n                                                                    this._componentLoaderStore);\r\n\r\n    this._riotControlDispatchStore = new RiotControlDispatchStore();\r\n    this._startupStore = new StartupStore();\r\n\r\n    riot.control.addStore(this._progressStore);\r\n    riot.control.addStore(this._componentLoaderStore);\r\n    riot.control.addStore(this._errorStore);\r\n    riot.control.addStore(this._fetchStore);\r\n    riot.control.addStore(this._localStorageStore);\r\n    riot.control.addStore(this._routeStore);\r\n    riot.control.addStore(this._pluginRegistrationStore);\r\n    riot.control.addStore(this._riotControlDispatchStore);\r\n    riot.control.addStore(this._keepAliveStore);\r\n    riot.control.addStore(this._startupStore);\r\n    riot.control.addStore(this._historyStore);\r\n\r\n    return riot;\r\n  }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/p7-host-core.js","export default class RiotRouteExtension {\r\n  constructor() {\r\n    var self = this;\r\n\r\n    self.name = 'RiotRouteExtension';\r\n    self.namespace = self.name + ':';\r\n    self.currentPath = '';\r\n\r\n    self._defaultParser = (path) =>{\r\n      self.currentPath = path;\r\n      return path.split(/[/?#]/);\r\n    };\r\n    self._getCurrentPath = () => {\r\n      return self.currentPath;\r\n    };\r\n    riot.route.parser(self._defaultParser, null);\r\n    riot.route.currentPath = self._getCurrentPath;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/extensions/riot-route-extension.js","import DeepFreeze from './utils/deep-freeze.js';\r\nimport RandomString from './utils/random-string.js';\r\nimport P7HostCore from './p7-host-core.js';\r\nimport Validator from './utils/validators.js';\r\nimport StoreBase from './stores/store-base.js';\r\n\r\nexport {\r\n  DeepFreeze, RandomString, P7HostCore, Validator, StoreBase\r\n };\r\n\r\nwindow.P7HostCore = {\r\n  DeepFreeze: DeepFreeze,\r\n  RandomString: RandomString,\r\n  Validator: Validator,\r\n  StoreBase: StoreBase\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/index.js","\r\nimport ProgressStore from './stores/progress-store.js';\r\nimport FetchStore from './stores/fetch-store.js';\r\nimport ComponentLoaderStore from './stores/component-loader-store.js';\r\nimport LocalStorageStore from './stores/localstorage-store.js';\r\nimport ErrorStore from './stores/error-store.js';\r\nimport HistoryStore from './stores/history-store.js';\r\nimport RouteStore from './stores/route-store.js';\r\nimport RiotControlDispatchStore from './stores/riotcontrol-dispatch-store.js';\r\nimport PluginRegistrationStore from './stores/plugin-registration-store.js';\r\nimport StartupStore from './stores/startup-store.js';\r\nimport KeepAliveStore from './stores/keep-alive-store.js';\r\nimport Router from './router.js';\r\n\r\nexport default class MasterEventTable {\r\n\r\n  constructor() {\r\n    riot.EVT = {};\r\n\r\n    riot.EVT.keepAliveStore = KeepAliveStore.constants.WELLKNOWN_EVENTS;\r\n    riot.EVT.progressStore = ProgressStore.constants.WELLKNOWN_EVENTS;\r\n    riot.EVT.routeStore = RouteStore.constants.WELLKNOWN_EVENTS;\r\n    riot.EVT.componentLoaderStore = ComponentLoaderStore.constants.WELLKNOWN_EVENTS;\r\n    riot.EVT.errorStore = ErrorStore.constants.WELLKNOWN_EVENTS;\r\n    riot.EVT.fetchStore = FetchStore.constants.WELLKNOWN_EVENTS;\r\n    riot.EVT.localStorageStore = LocalStorageStore.constants.WELLKNOWN_EVENTS;\r\n    riot.EVT.riotControlDispatchStore = RiotControlDispatchStore.constants.WELLKNOWN_EVENTS;\r\n    riot.EVT.pluginRegistrationStore = PluginRegistrationStore.constants.WELLKNOWN_EVENTS;\r\n    riot.EVT.startupStore = StartupStore.constants.WELLKNOWN_EVENTS;\r\n    riot.EVT.router = Router.constants.WELLKNOWN_EVENTS;\r\n    riot.EVT.historyStore = HistoryStore.constants.WELLKNOWN_EVENTS;\r\n  }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/master-event-table.js","\n    var riot = require('riot')\n    riot.tag2('startup', '', '', '', function(opts) {\n\tvar self = this;\n\n  riot.global.window = self.opts.window;\n\n  if(self.opts.config){\n    self.config = self.opts.config;\n  }\n  self.keepAlive = self.opts.keepAlive;\n  riot.state.keepAlive = { url:self.keepAlive };\n\n  self.nextTag = 'app';\n  if(self.opts.nextTag){\n    self.nextTag = self.opts.nextTag;\n  }\n  self.loaded = false;\n  self._bind =()=>{\n    riot.control.on('startup-store:config-complete',\n                    self.onConfigComplete);\n  }\n  self._unbind =()=>{\n    riot.control.off('startup-store:config-complete',\n                    self.onConfigComplete);\n  }\n\n  self.on('mount', () => {\n    self._bind();\n    riot.control.trigger(riot.EVT.startupStore.in.fetchConfig,self.config);\n    if(self.keepAlive){\n      riot.control.trigger('keep-alive-store:enable');\n    }\n  });\n\n  self.on('unmount', () => {\n    self._unbind();\n  });\n\n  self.onConfigComplete = () =>{\n    if(!self.loaded){\n      self.loaded = true;\n      self._unbind();\n      riot.control.trigger(riot.EVT.startupStore.in.start,self.nextTag);\n    }\n  }\n\n});\n    \n  \n\n\n// WEBPACK FOOTER //\n// ./app/p7-host-core/components/startup.tag","module.exports = __WEBPACK_EXTERNAL_MODULE_24__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"js-cookie\"\n// module id = 24\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_25__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"riot-route\"\n// module id = 25\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_26__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"riotcontrol\"\n// module id = 26\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_27__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"whatwg-fetch\"\n// module id = 27\n// module chunks = 0"],"sourceRoot":""}